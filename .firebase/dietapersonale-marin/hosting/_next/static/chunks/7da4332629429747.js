(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6923,e=>{"use strict";var t=e.i(77756);e.i(59180);var a=e.i(94565);let r="meals",s="profiles";async function l(e=null){if(!t.auth.currentUser)return[];let s=e||new Date,i=new Date(s);i.setHours(0,0,0,0);let o=new Date(s);o.setHours(23,59,59,999);let n=(0,a.query)((0,a.collection)(t.db,r),(0,a.where)("userId","==",t.auth.currentUser.uid),(0,a.where)("created_at",">=",a.Timestamp.fromDate(i)),(0,a.where)("created_at","<=",a.Timestamp.fromDate(o)),(0,a.orderBy)("created_at","desc"));return(await (0,a.getDocs)(n)).docs.map(e=>{let t=e.data();return{id:e.id,...t,created_at:t.created_at?.toDate?.()||new Date(t.created_at)}}).reverse()}async function i(e){if(!t.auth.currentUser)throw Error("User not authenticated");let s=e.created_at?a.Timestamp.fromDate(new Date(e.created_at)):a.Timestamp.now();return{id:(await (0,a.addDoc)((0,a.collection)(t.db,r),{...e,userId:t.auth.currentUser.uid,created_at:s})).id,...e,created_at:s.toDate()}}async function o(e){await (0,a.deleteDoc)((0,a.doc)(t.db,r,e))}async function n(e,s){let l=(0,a.doc)(t.db,r,e);await (0,a.updateDoc)(l,s)}async function c(){if(!t.auth.currentUser)return null;let e=(0,a.doc)(t.db,s,t.auth.currentUser.uid),r=await (0,a.getDoc)(e);return r.exists()?r.data():null}async function d(e){if(!t.auth.currentUser)throw Error("User not authenticated");let r=(0,a.doc)(t.db,s,t.auth.currentUser.uid);return await (0,a.setDoc)(r,{...e,updatedAt:a.Timestamp.now()}),e}e.s(["addMeal",()=>i,"deleteMeal",()=>o,"getMeals",()=>l,"getUserProfile",()=>c,"saveUserProfile",()=>d,"updateMeal",()=>n])},9982,(e,t,a)=>{t.exports=e.r(48750)},83178,e=>{"use strict";var t=e.i(78702);let a=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim(),r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:o="",children:n,iconNode:c,...d},u)=>(0,t.createElement)("svg",{ref:u,...s,width:r,height:r,stroke:e,strokeWidth:i?24*Number(l)/Number(r):l,className:a("lucide",o),...!n&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,a])=>(0,t.createElement)(e,a)),...Array.isArray(n)?n:[n]])),i=(e,s)=>{let i=(0,t.forwardRef)(({className:i,...o},n)=>(0,t.createElement)(l,{ref:n,iconNode:s,className:a(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,i),...o}));return i.displayName=r(e),i};e.s(["default",()=>i],83178)},36017,e=>{"use strict";let t=(0,e.i(83178).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>t],36017)},59830,e=>{"use strict";var t=e.i(778),a=e.i(78702),r=e.i(5475),s=e.i(9982),l=e.i(6923),i=e.i(83178);let o=(0,i.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),n=(0,i.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var c=e.i(36017);let d=(0,i.default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),u=(0,i.default)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),x=(0,i.default)("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),h=[{value:1.2,label:"Sedentario",desc:"Poco o nessun esercizio"},{value:1.375,label:"Leggero",desc:"Esercizio 1-3 giorni/settimana"},{value:1.55,label:"Moderato",desc:"Esercizio 3-5 giorni/settimana"},{value:1.725,label:"Attivo",desc:"Esercizio 6-7 giorni/settimana"},{value:1.9,label:"Molto Attivo",desc:"Atleta / lavoro fisico intenso"}],m=[{value:-500,label:"Dimagrire",desc:"-500 kcal/giorno (-0.5kg/sett.)"},{value:0,label:"Mantenere",desc:"Peso stabile"},{value:300,label:"Aumentare",desc:"+300 kcal/giorno (massa)"}];function b(){let e,i,b,f,p=(0,r.useAuth)(),g=(0,s.useRouter)(),v=p?.user,y=p?.loading??!0,[j,w]=(0,a.useState)(!0),[N,k]=(0,a.useState)(!1),[M,C]=(0,a.useState)(""),[U,D]=(0,a.useState)(""),[z,A]=(0,a.useState)(""),[S,E]=(0,a.useState)("male"),[P,T]=(0,a.useState)(1.55),[L,_]=(0,a.useState)(0);(0,a.useEffect)(()=>{y||v||g.push("/login")},[v,y,g]),(0,a.useEffect)(()=>{v&&F()},[v]);let F=async()=>{try{let e=await (0,l.getUserProfile)();e&&(C(e.weight||""),D(e.height||""),A(e.age||""),E(e.sex||"male"),T(e.activityLevel||1.55),_(e.goal||0))}catch(e){console.error("Error loading profile:",e)}finally{w(!1)}},H=async()=>{k(!0);try{await (0,l.saveUserProfile)({weight:parseFloat(M),height:parseFloat(U),age:parseInt(z),sex:S,activityLevel:P,goal:L,tdee:I(),targetCalories:R()}),g.push("/")}catch(e){alert("Errore nel salvataggio: "+e.message)}finally{k(!1)}},I=()=>{let e,t,a;return Math.round((e=parseFloat(M),t=parseFloat(U),a=parseInt(z),(e&&t&&a?"male"===S?10*e+6.25*t-5*a+5:10*e+6.25*t-5*a-161:0)*P))},R=()=>I()+L;if(y||j||!v)return(0,t.jsx)("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});let W=I(),B=R(),O=(e=R(),i=Math.round(2*(parseFloat(M)||70)),b=Math.round(.25*e/9),f=Math.round((e-4*i-9*b)/4),{protein:i,carbs:f,fat:b}),$=M&&U&&z;return(0,t.jsxs)("div",{className:"min-h-screen pb-8 px-4 pt-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,t.jsx)("button",{onClick:()=>g.push("/"),className:"h-10 w-10 glass-panel rounded-full flex items-center justify-center text-gray-400 hover:text-white transition",children:(0,t.jsx)(o,{size:20})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Il Mio Profilo"})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("section",{className:"glass-panel p-5 rounded-2xl",children:[(0,t.jsxs)("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[(0,t.jsx)(c.User,{size:20,className:"text-blue-400"}),"Dati Personali"]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-400 mb-1 block",children:"Peso (kg)"}),(0,t.jsx)("input",{type:"number",value:M,onChange:e=>C(e.target.value),placeholder:"70",className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:border-blue-500 focus:outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-400 mb-1 block",children:"Altezza (cm)"}),(0,t.jsx)("input",{type:"number",value:U,onChange:e=>D(e.target.value),placeholder:"175",className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:border-blue-500 focus:outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-400 mb-1 block",children:"Età"}),(0,t.jsx)("input",{type:"number",value:z,onChange:e=>A(e.target.value),placeholder:"30",className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:border-blue-500 focus:outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-400 mb-1 block",children:"Sesso"}),(0,t.jsxs)("select",{value:S,onChange:e=>E(e.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:border-blue-500 focus:outline-none",children:[(0,t.jsx)("option",{value:"male",children:"Uomo"}),(0,t.jsx)("option",{value:"female",children:"Donna"})]})]})]})]}),(0,t.jsxs)("section",{className:"glass-panel p-5 rounded-2xl",children:[(0,t.jsxs)("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[(0,t.jsx)(d,{size:20,className:"text-emerald-400"}),"Livello Attività"]}),(0,t.jsx)("div",{className:"space-y-2",children:h.map(e=>{let a=P===e.value;return(0,t.jsx)("button",{onClick:()=>T(e.value),className:"w-full text-left p-4 rounded-xl border-2 transition",style:{backgroundColor:a?"rgba(16, 185, 129, 0.4)":"rgba(30, 41, 59, 0.5)",borderColor:a?"#34d399":"#334155",boxShadow:a?"0 10px 25px rgba(16, 185, 129, 0.3)":"none"},children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{color:a?"#6ee7b7":"#ffffff",fontWeight:600},children:e.label}),(0,t.jsx)("div",{className:"text-sm text-gray-400",children:e.desc})]}),a&&(0,t.jsx)("div",{style:{width:28,height:28,backgroundColor:"#10b981",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})})]})},e.value)})})]}),(0,t.jsxs)("section",{className:"glass-panel p-5 rounded-2xl",children:[(0,t.jsxs)("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[(0,t.jsx)(u,{size:20,className:"text-amber-400"}),"Obiettivo"]}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:m.map(e=>{let a=L===e.value;return(0,t.jsxs)("button",{onClick:()=>_(e.value),className:"p-4 rounded-xl border-2 transition text-center",style:{backgroundColor:a?"rgba(245, 158, 11, 0.4)":"rgba(30, 41, 59, 0.5)",borderColor:a?"#fbbf24":"#334155",boxShadow:a?"0 10px 25px rgba(245, 158, 11, 0.3)":"none"},children:[(0,t.jsx)("div",{style:{color:a?"#fcd34d":"#ffffff",fontWeight:600,fontSize:"0.875rem"},children:e.label}),a&&(0,t.jsx)("div",{style:{color:"#fbbf24",fontSize:"0.75rem",marginTop:"0.25rem"},children:"✓"})]},e.value)})})]}),$&&(0,t.jsxs)("section",{className:"glass-panel p-5 rounded-2xl bg-gradient-to-br from-blue-500/10 to-purple-500/10",children:[(0,t.jsxs)("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[(0,t.jsx)(x,{size:20,className:"text-blue-400"}),"Il Tuo Fabbisogno"]}),(0,t.jsxs)("div",{className:"text-center mb-4",children:[(0,t.jsx)("div",{className:"text-5xl font-black text-white",children:B}),(0,t.jsx)("div",{className:"text-gray-400",children:"kcal / giorno"})]}),(0,t.jsxs)("div",{className:"flex justify-around text-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-blue-400",children:[O.protein,"g"]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Proteine"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-emerald-400",children:[O.carbs,"g"]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Carboidrati"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-amber-400",children:[O.fat,"g"]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Grassi"})]})]}),(0,t.jsxs)("div",{className:"mt-4 text-xs text-gray-500 text-center",children:["TDEE base: ",W," kcal • Obiettivo: ",L>0?"+":"",L," kcal"]})]}),(0,t.jsx)("button",{onClick:H,disabled:!$||N,className:"w-full h-14 bg-gradient-to-r from-blue-500 to-purple-500 text-white font-bold rounded-2xl flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed hover:opacity-90 transition active:scale-95",children:N?(0,t.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n,{size:20}),"Salva Profilo"]})})]})]})}e.s(["default",()=>b],59830)}]);